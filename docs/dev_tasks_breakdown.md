# 開発タスク分解（MVP〜拡張）

本ドキュメントは、開発を進める際のタスクを粒度細かく整理したものです。
**最短で「1本の動画が出力できる」縦串を作る**ことを優先しつつ、
将来の拡張や運用まで見失わない構成にしています。

---

## 0. 前提整備
- [x] `.env` と `config/` のテンプレ整理（必要キー一覧の明文化）
- [x] Prisma `schema.prisma` の見直し（成果物管理の拡張余地確認）
- [x] ローカル開発起動フローの整理（`pnpm dev` の役割確認）

## 1. データモデル / 共有型
- [x] `packages/shared` に台本（Script）型定義を追加
- [x] 生成物（音声/字幕/画像/動画）メタデータ型の追加
- [ ] ワークフロー入出力の共通インターフェース定義

## 2. ワークフロー基盤（MVP）
- [ ] `packages/core` のステップ実装フック整理
- [ ] `projects/[id]/` の出力ディレクトリ規約の明文化
- [ ] `ProjectFile` への成果物登録ユーティリティ
- [ ] 失敗時の再実行・スキップの設計

---

## 3. MVPの縦串（まず動画が出る最小構成）

### 3-1. Script Generation（簡易実装）
- [ ] 台本を固定テンプレ or LLM最小実装で作成
- [ ] `script.json` を保存
- [ ] DBに出力ファイルを登録

### 3-2. TTS Generation（簡易実装）
- [ ] 台本JSONからセリフを読み込み
- [ ] ダミー音声 or 既存音声を結合して出力
- [ ] タイムスタンプJSONを作成（簡易で可）
- [ ] DBに出力ファイルを登録

### 3-3. Subtitle Generation（簡易実装）
- [ ] タイムスタンプ情報から字幕生成
- [ ] ASSまたはJSON形式で出力
- [ ] DBに登録

### 3-4. Video Composition（最低限）
- [ ] Remotionで背景/立ち絵/字幕/音声を合成
- [ ] MP4出力
- [ ] DBに出力ファイルを登録

### 3-5. Final Encoding（最低限）
- [ ] YouTube向け最小設定で再エンコード
- [ ] 最終成果物の出力確認

---

## 4. Web GUI（初期版）
- [ ] ダッシュボード（プロジェクト一覧）
- [ ] プロジェクト作成ウィザード
- [ ] プロジェクト詳細（進捗/ログ/成果物）
- [ ] 台本編集画面（JSON編集/簡易UI）
- [ ] 素材管理画面（アップロード/差し替え）
- [ ] タイムライン編集画面（読み取り中心の表示から開始）
- [ ] プレビュー & レンダリング画面
- [ ] 設定画面（APIキー/出力プリセット）

---

## 5. タイムライン編集の段階的実装
- [ ] タイムラインデータ構造の設計（Track / Clip / Marker）
- [ ] 再生範囲の指定（in/out）
- [ ] クリップのドラッグ移動（開始位置変更）
- [ ] クリップのリサイズ（長さ変更）
- [ ] 基本パラメータ編集（フェード、音量、字幕スタイル）
- [ ] タイムライン → Remotion の同期

---

## 6. AI連携の拡張
- [ ] Theme Selection（トレンド取得/評価ロジック）
- [ ] Title Generation（CTR最適化）
- [ ] Background / Illustration Generation
- [ ] Character Synthesis（口パク/表情）

---

## 7. 運用性 / 安定性
- [ ] ステップごとのリトライ方針
- [ ] 生成物のキャッシュ/再利用
- [ ] 監視ログ（失敗原因の集計）

---

## 8. 将来拡張（任意）
- [ ] YouTube Upload（API連携）
- [ ] プロジェクトのテンプレ化
- [ ] 複数ユーザー対応（将来）
